## Shell Script

### 注释

* 单行注释

  ```shell
  # 单行注释
  ```

* 多行注释

  ```shell
  :<<!
  注释内容，固定格式
  !
  ```

  ```shell
  :<<str
  注释内容，str自定义
  str
  ```

---

### 设置变量

#### 本地变量

> 在特定环境下才生效的变量，作用范围小

* 普通变量——变量值是数字、普通字符串、可解析字段

  **定义方法**：

  1. 变量名=变量值（变量值是数字时使用）

     `variate=value`

     ```shell
     GOPATH=/usr/local/bin
     ```

     > 变量名必须是整体，中间不能有特殊字符

  2. 变量名='变量值' 

     `variate='valus'`

     ```shell
     PYTHONPATH='/usr/local/bin/python3.6'
     ```

     > 所见即所得

  3. 变量名="变量值"（其他情况时使用）

     `variate="value"`

     ```shell
     GOPATH="/usr/local/bin:$PATH"
     ```

     > 先解析双引号内可能有的可解析字段，再将value赋值给variate

* 命令变量——变量值是一个命令

  **定义方法**：

  1. 变量名=\`命令\`

     ```shell
     PWD=`pwd`
     ```

     > 反引号，执行该反引号内的命令

  2. 变量名=$(命令)

     ```shell
     PWD=$(pwd)
     ```

     > 执行括号里的命令，将结果作为变量值赋值给变量名

#### 全局变量

> 当前系统所有环境都生效的变量

* 查看全局环境变量

  `env`	# 只显示全局变量

* 定义全局变量

  * 分步式
    1. 变量名=变量值
    2. export 变量名
  * export 变量名=变量值



### 查看变量

1. echo "${变量名}"

   ```sh
   echo "${PATH}"
   ```

   > 标准方法，可以**echo "other...${变量名}...other"**添加其他自定义信息

2. echo ${变量名}

   ```shell
   echo ${PATH}
   ```

   > 使用频率较高

3. echo "$变量名"  &  echo \$变量名

   ```shell
   echo "$PATH"
   echo $PATH
   ```

   > 省事



### 取消变量

* unset 变量名

  ```shell
  unset GOPATH
  ```



### Shell内置变量

#### shell脚本相关：

|  符号  |                             意义                             |
| :----: | :----------------------------------------------------------: |
|  `$0`  |              获取当前执行脚本的绝对路径+脚本名               |
| `$num` | 获取当前执行脚本的第num个参数，num=[1, 9]，当num>9时候需要${num} |
|  `$#`  |                获取当前执行脚本的参数的总个数                |
|  `$?`  |      获取上一个命令的执行状态（0代表成功，!0代表失败）       |
|  `$!`  |                   获取上一个后台命令的PID                    |



### 字符串处理

* 字符串精确截取

  > 格式：${变量名:起始位置:截取长度}
  >
  > 初始下标为0

  |           示例            |         解释          |
  | :---------------------: | :-----------------: |
  |  `${variate_name:0:5}`  |   从第0个字符开始，截取5个字符   |
  |  `${variate_name::5}`   |   从第0个字符开始，截取5个字符   |
  |  `${variate_name:5:5}`  |   从第5个字符开始，截取5个字符   |
  |   `${variate_name:5}`   |  从第5个字符开始，截取后面所有字符  |
  |  `${variate_name:0-5}`  | 从倒数第5个字符开始，截取后面所有字符 |
  | `${variate_name:0-6:3}` |  从倒数第6个字符开始，截取3个字符  |

#### 默认值

1. 变量variate如果有内容，则使用variate的值；变量variate如果没有内容，则使用默认值

   ```shell
   #! /bin/bash
   # test.sh
   # ${变量名:-默认值}
   
   v="$1"
   echo "v的值是——${v:-1}"
   ```

   > bash test.sh test	# 输出：v的值是——test
   >
   > bash test.sh		# 输出：v的值是——1

2. 无论变量variate内容是什么，都输出默认值

   ```shell
   #! /bin/bash
   # test.sh
   # ${变量名:-默认值}
   
   v="$1"
   echo "v的值是——${v:+1}"
   ```

   > bash test.sh test
   >
   > \>>> v的值是——1
   >
   > bash test.sh
   >
   > \>>> v的值是——	# 不给定v的值时置空